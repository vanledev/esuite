var ot=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);import{p as j,y as ut,g as Y,r as x,i as ct,a as B,b as Q,f as lt,c as R,L as ie,M as H,d as ke,t as F,S as de,e as ft,h as dt,j as gt,k as oe,l as He,m as pt,n as mt,o as ht}from"./index-DllLHsfL.js";import{m as v,k as b,T,M as ge,w as pe,p as M,h as O,e as yt}from"./const-BQq-fb5X.js";import{b as bt,A as wt,I as vt,h as Tt,g as _t,C as At,y as It,m as Pt,u as St,p as me,d as he,P as ye}from"./index-4Xml3FNN.js";var Aa=ot((A,I)=>{function Et(t){const{hostMatch:e,extensionId:r,extensionName:n}=t;chrome.tabs.onUpdated.addListener(async(a,s,i)=>{if(i&&i.url&&i&&i.url&&s&&s.status==="loading"){const o=new URL(i.url).hostname;if(e.find(u=>!!~u.indexOf(o))){const u=chrome.runtime.getManifest();chrome.scripting.executeScript({injectImmediately:!0,world:"MAIN",target:{tabId:a,allFrames:!0},func:f=>{window[f.slug]=f},args:[{id:chrome.runtime.id,slug:r,extensionName:n,version:u.version,icons:u.icons,extensionFolderUri:chrome.runtime.getURL("/"),isProdMode:"update_url"in chrome.runtime.getManifest()}]})}}})}var Mt=Object.defineProperty,Ot=(t,e,r)=>e in t?Mt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,N=(t,e,r)=>(Ot(t,typeof e!="symbol"?e+"":e,r),r);class Ye{constructor(e,r){N(this,"listeners",{}),N(this,"tabs",[]),N(this,"slug"),N(this,"isDebugger"),this.slug=e,this.isDebugger=!!r,this.bindMessage(),this.bindEvent()}on(e,r){if(this.listeners[e])throw new Error(`event listener ${String(e)} already exist!`);return this.listeners[e]=r,()=>{delete this.listeners[e]}}async send(e,...r){this.isDebugger&&console.log("send message from background script",{action:e,payload:r,tabs:this.tabs});for(let n of this.tabs)try{const a=await chrome.tabs.get(n);a&&a.id?chrome.tabs.sendMessage(a.id,{from:this.slug,payload:{action:e,payload:r}}):this.deleteTabById(n)}catch(a){console.log(a),this.deleteTabById(n)}}bindMessage(){chrome.runtime.onMessageExternal.addListener((e,r,n)=>{var a,s;if((a=r==null?void 0:r.tab)!=null&&a.id){if(this.isDebugger&&console.log("received message from page",{request:e,sender:r}),e.action==="__connect")return this.tabs.includes(r.tab.id)||this.tabs.push(r.tab.id),n();if(e.action==="__disconnect")return this.deleteTabById(r.tab.id),n();if(this.listeners[e.action])return(s=r==null?void 0:r.tab)!=null&&s.id?(this.tabs.includes(r.tab.id)||this.tabs.push(r.tab.id),this.listeners[e.action](...e.payload).then(i=>{this.isDebugger&&console.log("send to callback from background",{request:e,sender:r,res:i}),n(i)}),!0):n();console.log(`unknown event ${e.action}`)}})}bindEvent(){chrome.tabs.onRemoved.addListener(e=>{this.deleteTabById(e)})}deleteTabById(e){if(this.tabs.includes(e)){const r=this.tabs.indexOf(e);this.tabs.splice(r,1)}}}const Ct="1IbzeYQ4G7u",Lt={type:"object",properties:{},default:{}},Rt={__GraphQLUserToken:Lt},{updateBucket:xt,setBucket:Ma,getBucket:Ft,deleteBucket:$t}=j(Rt);let X=!1;function Bt(t){const e={ALmNj:function(n,a){return n(a)},Bqazr:function(n,a){return n!==a},SzfYw:"Network Error!",uOrlf:"__GraphQLUserToken",otywo:function(n,a){return n===a},RrpCQ:function(n,a){return n==a},mKSEp:"complete",ZqBNl:"facebook.com/v19.0/dialog/oauth",QlfLh:"MAIN",SrpMc:"instagram.com/#",AIcAn:function(n,a){return n(a)},JfcGy:function(n,a,s){return n(a,s)},kYaIN:function(n,a,s){return n(a,s)},jHcTF:"Graphql must have https://www.instagram.com/* permission",jKeSQ:function(n,a){return n in a},eeuYk:"update_url",GEzAT:"__fetchGraphQl",WDlyu:"__getUserToken",NcupJ:"__deleteUserToken",oOdLG:"__getTokenAfterRedirection",mwQGT:"__updateUserToken"};if(!t.hostMatch.find(n=>!!~n.indexOf("https://www.instagram.com/*")))throw new Error(e.jHcTF);const r=new Ye(t.projectId,!e.jKeSQ(e.eeuYk,chrome.runtime.getManifest()));r.on(e.GEzAT,async n=>{const a=await e.ALmNj(fetch,n);return e.Bqazr(200,a.status)?{error:{code:a.status,message:e.SzfYw}}:await a.json()}),r.on(e.WDlyu,async()=>{const n=await e.ALmNj(Ft,e.uOrlf);return!(!n.token||!n.scopes)&&n}),r.on(e.NcupJ,async()=>{await e.ALmNj($t,e.uOrlf)}),r.on(e.oOdLG,async n=>X?Promise.resolve(""):(X=!0,new Promise(a=>{const s={zHSPE:function(i,o){return e.otywo(i,o)},kyatD:function(i,o){return e.RrpCQ(i,o)},UOYBa:e.mKSEp,tXDiq:e.ZqBNl,gIaFt:e.QlfLh,SFGgl:e.SrpMc,sYKvP:function(i,o){return e.ALmNj(i,o)},RyPTr:function(i,o){return e.AIcAn(i,o)},XmvEB:function(i,o,u){return e.JfcGy(i,o,u)}};chrome.tabs.query({active:!0,lastFocusedWindow:!0},function(i){const o=function(c,l){return s.RyPTr(c,l)},u=function(c,l){return s.sYKvP(c,l)},f=i[0]??{},g=f==null?void 0:f.id;chrome.tabs.create({url:n},c=>{const l={jqgRy:function(m,h){return s.zHSPE(m,h)},xbxen:function(m,h){return s.kyatD(m,h)},nMFcB:s.UOYBa,yqOAC:s.tXDiq,rvRlB:s.gIaFt,jBIMi:s.SFGgl,lRphC:function(m,h){return s.sYKvP(m,h)},OTvIb:function(m,h){return s.RyPTr(m,h)}};let d=!1;function p(m,h,_){if(l.jqgRy(m,c.id)&&l.xbxen(l.nMFcB,h.status)){const C=_.url;if(~C.indexOf(l.yqOAC))chrome.scripting.executeScript({injectImmediately:!1,world:l.rvRlB,target:{tabId:_.id,allFrames:!0},func:()=>{window.setInterval(()=>{try{document.querySelector('[name="__CONFIRM__"]').click()}catch{}},100)}});else if(~C.indexOf(l.jBIMi)){d=!0,l.lRphC(w,_.id);const S=C.match(/access_token=(.+?)(&|$)/);l.OTvIb(a,S[1]?S[1]:"")}}}function w(m){chrome.tabs.remove(m),chrome.tabs.onUpdated.removeListener(p),g&&chrome.tabs.update(g,{active:!0})}chrome.tabs.onUpdated.addListener(p),chrome.tabs.onRemoved.addListener(m=>{d||(o(w,m),u(a,""))}),s.XmvEB(setTimeout,()=>{!d&&l.lRphC(a,"")},1e4)})})}).finally(()=>{X=!1}))),r.on(e.mwQGT,async n=>{await e.kYaIN(xt,e.uOrlf,s=>n);const a=await chrome.tabs.query({url:t.hostMatch});if(a)for(let s of a)s!=null&&s.id&&chrome.scripting.executeScript({injectImmediately:!0,world:e.QlfLh,target:{tabId:s.id,allFrames:!0},func:(i,o)=>{window[o]=i},args:[n,Ct]})})}var Qe=(t=>(t[t.FREE=0]="FREE",t[t.BASIC=1]="BASIC",t[t.PREMIUM=2]="PREMIUM",t))(Qe||{});const Dt={type:"object",properties:{uid:{type:"string",default:""},email:{type:"string",default:""},stripeId:{type:"string",default:""},name:{type:"string",default:""},payments:{type:"array",items:{type:"object",properties:{},required:[],default:{}},default:[]},plan:{type:"string",default:Qe.FREE},isSubscriptionActive:{type:"boolean",default:!1},lastCheckAt:{type:"number",default:0}},required:["uid","email","stripeId","name","payments","plan","isSubscriptionActive","lastCheckAt"],default:{}},jt={type:"object",properties:{},required:[],default:{}},Ut={type:"object",properties:{},required:[],default:{}},z={customerDataV2:Dt,features:jt,persistLocalStorage:Ut};function ze(){return Math.floor(new Date().getTime()/1e3)}function be(t){return t+86400<ze()}async function Nt(t){const e=await chrome.tabs.query({url:t.filter(r=>!~r.indexOf("esuit"))});for(let r of e)r.id&&await chrome.tabs.reload(r.id)}let G=[];const{updateBucket:we,getBucket:J,deleteBucket:ve}=j(z);function Gt(t){v("logout",async()=>{await ve("customerDataV2"),await ve("features")}),v("login",async()=>{const e=new URLSearchParams({[ge.RETURN_EXT_LOCAL]:chrome.runtime.id}).toString();await chrome.tabs.create({url:`https://esuit.dev/login?${e}`,active:!0})}),v("closePopup",async()=>{chrome.extension.getViews({type:"popup"}).forEach(e=>{e.window.close()})}),v("openOptionsPage",async e=>{const r=chrome.runtime.getURL("src/pages/options/index.html"+(e?"#showSubscription=1":""));(await chrome.tabs.query({url:[r]})).forEach(n=>(n==null?void 0:n.id)&&chrome.tabs.remove(n.id)),await new Promise(n=>setTimeout(n,300)),await chrome.tabs.create({url:r,active:!0})}),v("getCustomerData",async()=>{const e=await J("customerDataV2");if(e.uid)return be(e.lastCheckAt)&&b("reFetchCustomerData"),e}),v("reFetchCustomerData",async(e=!1)=>{const r=await J("customerDataV2"),n=r.uid;if(!n)return!1;if(!e&&n&&!be(r.lastCheckAt))return!0;let a=null,s=null;try{const[u,f]=await Promise.all([fetch(`https://getusersubscription-57pphaecyq-uc.a.run.app/?token=${bt(n,t.projectId)}`).then(g=>g.json()),qt()]);if(u.stripeId&&(a=u),f){const g=f.find(c=>c.projectId===t.projectId);g&&(s=g)}}catch(u){return console.error(u),"Unknown error, please contact the developer."}if(!a||!s)return"ERROR: reFetchCustomerData returned undefined";let i=a.allPayments.filter(u=>wt(u.status)||vt(u.status)||Tt(u.status)||_t(u.status)||At(u.status)),o=T.FREE;return Te(i,s,T.BASIC)&&(o=T.BASIC),Te(i,s,T.PREMIUM)&&(o=T.PREMIUM),await we("customerDataV2",async u=>a?{uid:n,stripeId:a.stripeId,email:a.email,name:a.name,payments:a.allPayments,plan:o,isSubscriptionActive:o!==T.FREE,lastCheckAt:ze()}:u),b("rejectFeaturesToWindow"),!0}),v("visitPricingPage",async()=>{const e=`https://esuit.dev/pricing/${t.projectId}`,r=new URLSearchParams({[ge.RETURN_EXT_LOCAL]:chrome.runtime.id}).toString();await chrome.tabs.create({url:e+`?${r}`,active:!0})}),v("visitDashboard",async()=>{await chrome.tabs.create({url:"https://esuit.dev/dashboard",active:!0}),b("closePopup")}),pe("ifUserLogin",async()=>!!(await J("customerDataV2")).uid),pe("userInfoUpdate",async([e])=>{e&&(await we("customerDataV2",r=>(r.uid=e,r)),await b("reFetchCustomerData",!0),b("openOptionsPage",!0),setTimeout(()=>{Nt(t.hostMatch)},2e3))})}async function qt(){if(G.length>0)return G;const t=await fetch("https://static-data.esuit.dev/index.json").then(e=>e.json());return G=It(t),G}function Te(t,e,r){return!!t.find(n=>{if(![...Pt,...St,...me,...he,...ye].includes(n.status)||[...me].includes(n.status)&&(!n.nextBillingDate||n.nextBillingDate<Math.ceil(new Date().getTime()/1e3))||[...he].includes(n.status)&&(!n.nextBillingDate||n.nextBillingDate<Math.ceil(new Date().getTime()/1e3))||[...ye].includes(n.status)&&(!n.nextBillingDate||n.nextBillingDate<Math.ceil(new Date().getTime()/1e3)))return!1;const a=e.prices.find(s=>s.id===n.priceId);return!(!a||a.plan!==r)})}var Kt=Object.defineProperty,kt=(t,e,r)=>e in t?Kt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,q=(t,e,r)=>(kt(t,typeof e!="symbol"?e+"":e,r),r);class ue{constructor(e,r){q(this,"listeners",{}),q(this,"tabs",[]),q(this,"slug"),q(this,"isDebugger"),this.slug=e,this.isDebugger=!!r,this.bindMessage(),this.bindEvent()}on(e,r){if(this.listeners[e])throw new Error(`event listener ${String(e)} already exist!`);return this.listeners[e]=r,()=>{delete this.listeners[e]}}async send(e,...r){this.isDebugger&&console.log("send message from background script",{action:e,payload:r,tabs:this.tabs});for(let n of this.tabs)try{const a=await chrome.tabs.get(n);a&&a.id?chrome.tabs.sendMessage(a.id,{from:this.slug,payload:{action:e,payload:r}}):this.deleteTabById(n)}catch(a){console.log(a),this.deleteTabById(n)}}bindMessage(){chrome.runtime.onMessageExternal.addListener((e,r,n)=>{var a,s;if((a=r==null?void 0:r.tab)!=null&&a.id){if(this.isDebugger&&console.log("received message from page",{request:e,sender:r}),e.action==="__connect")return this.tabs.includes(r.tab.id)||this.tabs.push(r.tab.id),n();if(e.action==="__disconnect")return this.deleteTabById(r.tab.id),n();if(this.listeners[e.action])return(s=r==null?void 0:r.tab)!=null&&s.id?(this.tabs.includes(r.tab.id)||this.tabs.push(r.tab.id),this.listeners[e.action](...e.payload).then(i=>{this.isDebugger&&console.log("send to callback from background",{request:e,sender:r,res:i}),n(i)}),!0):n();console.log(`unknown event ${e.action}`)}})}bindEvent(){chrome.tabs.onRemoved.addListener(e=>{this.deleteTabById(e)})}deleteTabById(e){if(this.tabs.includes(e)){const r=this.tabs.indexOf(e);this.tabs.splice(r,1)}}}function Ht(t){return[T.FREE,T.BASIC,T.PREMIUM].indexOf(t)}function Yt(t,e){const r=Ht(e);return t.limitation?t.limitation[r]:0}function _e(t,e){return{[T.FREE]:1,[T.BASIC]:10,[T.PREMIUM]:100}[e]>=t.permission}function W(t,e){return t.map(r=>{e[r.key]?(e[r.key].enable=e[r.key].enable??r.defaultEnable,e[r.key].currentFreeTryCount=e[r.key].currentFreeTryCount??0):e[r.key]={enable:r.defaultEnable,currentFreeTryCount:0}}),e}function Qt(t){const{cacheId:e,defaultMemoConfig:r}=t;v("setUIMemoSettings",async n=>{await chrome.storage.local.set({[e]:n})}),v("getUIMemoSettings",async()=>{const n=await b("getFeaturesDataByPlan");let a=await new Promise(s=>{chrome.storage.local.get([e]).then(i=>{i[e]?s(i[e]):s(!1)})});return a||(a={...r}),Object.keys(a).map(s=>{const i=Object.values(n).find(u=>u._.memoKey===s);if(i&&i.needUpgrade&&(!i.enable||!(i.freeTryLeft>0||i.limitation>0)&&r[s]!==void 0))return o();function o(){a[s]=r[s]}}),{...r,...a}})}let Xe=!1;function zt(){return Xe}function Xt(){Xe=!0}const{updateBucket:Z,getBucket:Ae}=j(z);function Jt(t){if(zt())return;Xt();const e=new ue(t,!0);return v("getAllPersistLocalStorage",()=>Ae("persistLocalStorage")),v("setPersistLocalStorage",async(r,n)=>{await Z("persistLocalStorage",a=>{try{n=JSON.stringify(n)}catch{}return a[r]=n,a})}),v("getPersistLocalStorage",async(r,n)=>{const a=await Ae("persistLocalStorage");if(a[r]){try{return JSON.parse(a[r])}catch{}return a[r]}return n??void 0}),v("clearPersistLocalStorage",async()=>{Z("persistLocalStorage",()=>({}))}),v("removePersistLocalStorage",async r=>{Z("persistLocalStorage",n=>(delete n[r],n))}),e.on("getAllPersistLocalStorage",()=>b("getAllPersistLocalStorage")),e.on("setPersistLocalStorage",(...r)=>b("setPersistLocalStorage",...r)),e.on("getPersistLocalStorage",(...r)=>b("getPersistLocalStorage",...r)),e.on("clearPersistLocalStorage",()=>b("clearPersistLocalStorage")),void e.on("removePersistLocalStorage",r=>b("removePersistLocalStorage",r))}const{setBucket:Ie,getBucket:V}=j(z);function Wt(t){const{projectId:e,hostMatch:r,cacheId:n,features:a,defaultMemoConfig:s}=t,i=new ue(e,!0);return Jt(t.projectId),Qt({cacheId:n,defaultMemoConfig:s}),chrome.tabs.onUpdated.addListener(async(c,l,d)=>{if(d&&d.url&&l.status==="loading"){const p=new URL(d.url).hostname;r.find(w=>!!~w.indexOf(p))&&u(c)}}),chrome.storage.onChanged.addListener((c,l)=>{l==="local"&&c&&c.features&&o()}),v("rejectFeaturesToWindow",async()=>{o()}),v("getFeature",async c=>f()[c]),v("consumeFeaturesTreeTryByMemoUIConfigs",async c=>{const l=await f();let d=[];Object.entries(c).map(([p,w])=>{if(s[p]!==void 0&&s[p]!==w){const m=Object.values(l).find(h=>h._.memoKey===p);m&&m.isCanFreeTry&&d.push(m._.key)}}),d.length>0&&b("consumeFeatureTreeTry",d)}),v("consumeFeatureTreeTry",async c=>{let l=W(a,await V("features"));const d=await g();let p=!1;c.map(w=>{const m=a.find(h=>h.key===w||h.memoKey===w);m&&(_e(m,d)||(l[m.key].currentFreeTryCount++,p=!0))}),p&&await Ie("features",l)}),v("saveFeaturesEnables",async c=>{let l=W(a,await V("features"));Object.entries(c).map(([d,p])=>{l[d].enable=p}),await Ie("features",l)}),v("getFeaturesDataByPlan",f),i.on("getUIMemoSettings",()=>b("getUIMemoSettings")),i.on("setUIMemoSettings",c=>b("setUIMemoSettings",c)),i.on("consumeFeatureTreeTry",c=>b("consumeFeatureTreeTry",c)),i.on("visitPricingPage",()=>b("visitPricingPage")),void i.on("consumeFeaturesTreeTryByMemoUIConfigs",c=>{b("consumeFeaturesTreeTryByMemoUIConfigs",c)});async function o(){const c=await chrome.tabs.query({url:r});c&&c.map(l=>{l&&l.id&&u(l.id)})}async function u(c){const l=await f();chrome.scripting.executeScript({injectImmediately:!0,world:"MAIN",target:{tabId:c,allFrames:!0},func:(d,p)=>{window[p]=JSON.parse(d)},args:[JSON.stringify(l),`${e.replaceAll("-","_")}`]})}async function f(){const c=await g();let l=W(a,await V("features"));return a.map(d=>{var p;const w=_e(d,c);let m,h=0;return d.memoKey&&(m=s[d.memoKey]),d.maxFreeTryCount&&l[d.key].currentFreeTryCount!==void 0&&(h=Math.max(0,d.maxFreeTryCount-l[d.key].currentFreeTryCount)),{enable:((p=l[d.key])==null?void 0:p.enable)??d.defaultEnable,needUpgrade:!w,limitation:Yt(d,c),permission:d.permission,freeTryLeft:d.maxFreeTryCount?h:0,isCanFreeTry:!!d.maxFreeTryCount&&d.maxFreeTryCount>0,defaultValue:m,_:d}}).reduce((d,p)=>(d[p._.key]=p,d),{})}async function g(){const c=await b("getCustomerData");return c?c.plan:T.FREE}}function Zt(t,e){(async()=>{let r=0,n=(await chrome.declarativeNetRequest.getDynamicRules()).map(s=>s.id);const a=t.map((s,i)=>(r=i+1,{id:r,priority:1,action:{type:"modifyHeaders",responseHeaders:[{header:"Content-Security-Policy",operation:"remove"},{header:"Content-Security-Policy-Report-Only",operation:"remove"}]},condition:{regexFilter:s,resourceTypes:["main_frame","xmlhttprequest"]}}));e&&e.length>0&&e.map(s=>{s.id=++r,a.push(s)}),await chrome.declarativeNetRequest.updateDynamicRules({removeRuleIds:n,addRules:a})})()}function Vt(t){const e=new ue(t,!0);e.on("reFetchCustomerData",r=>b("reFetchCustomerData",r)),e.on("visitDashboard",()=>b("visitDashboard")),e.on("getCustomerData",()=>b("getCustomerData")),e.on("logout",()=>b("logout")),e.on("login",()=>b("login"))}function er(t){ut(z),Gt(t),Vt(t.projectId)}const tr=[{key:"fetchLimit",name:"Fetch limit",permission:1,limitation:[300,0,0],defaultEnable:!0,memoKey:null},{key:"RESUME_EXPORTING",name:"Resume Exporting",permission:10,maxFreeTryCount:3,defaultEnable:!0,memoKey:null}],rr={fullSpeed:!1,isExtraFields:!1,isExtraConcatInfo:!1,isExtraMutualFriendsCount:!1};function nr(t){return t}var re=Y(x,"WeakMap");function ar(){}function sr(t,e,r,n){for(var a=t.length,s=r+(n?1:-1);n?s--:++s<a;)if(e(t[s],s,t))return s;return-1}function ir(t){return t!==t}function or(t,e,r){for(var n=r-1,a=t.length;++n<a;)if(t[n]===e)return n;return-1}function ur(t,e,r){return e===e?or(t,e,r):sr(t,ir,r)}function cr(t,e){var r=t==null?0:t.length;return!!r&&ur(t,e,0)>-1}var lr=9007199254740991,fr=/^(?:0|[1-9]\d*)$/;function Je(t,e){var r=typeof t;return e=e??lr,!!e&&(r=="number"||r!="symbol"&&fr.test(t))&&t>-1&&t%1==0&&t<e}var dr=9007199254740991;function ce(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=dr}function gr(t){return t!=null&&ce(t.length)&&!ct(t)}var pr=Object.prototype;function mr(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||pr;return t===r}function hr(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}var yr="[object Arguments]";function Pe(t){return B(t)&&Q(t)==yr}var We=Object.prototype,br=We.hasOwnProperty,wr=We.propertyIsEnumerable,Ze=Pe(function(){return arguments}())?Pe:function(t){return B(t)&&br.call(t,"callee")&&!wr.call(t,"callee")};function vr(){return!1}var Ve=typeof A=="object"&&A&&!A.nodeType&&A,Se=Ve&&typeof I=="object"&&I&&!I.nodeType&&I,Tr=Se&&Se.exports===Ve,Ee=Tr?x.Buffer:void 0,_r=Ee?Ee.isBuffer:void 0,ne=_r||vr,Ar="[object Arguments]",Ir="[object Array]",Pr="[object Boolean]",Sr="[object Date]",Er="[object Error]",Mr="[object Function]",Or="[object Map]",Cr="[object Number]",Lr="[object Object]",Rr="[object RegExp]",xr="[object Set]",Fr="[object String]",$r="[object WeakMap]",Br="[object ArrayBuffer]",Dr="[object DataView]",jr="[object Float32Array]",Ur="[object Float64Array]",Nr="[object Int8Array]",Gr="[object Int16Array]",qr="[object Int32Array]",Kr="[object Uint8Array]",kr="[object Uint8ClampedArray]",Hr="[object Uint16Array]",Yr="[object Uint32Array]",y={};y[jr]=y[Ur]=y[Nr]=y[Gr]=y[qr]=y[Kr]=y[kr]=y[Hr]=y[Yr]=!0;y[Ar]=y[Ir]=y[Br]=y[Pr]=y[Dr]=y[Sr]=y[Er]=y[Mr]=y[Or]=y[Cr]=y[Lr]=y[Rr]=y[xr]=y[Fr]=y[$r]=!1;function Qr(t){return B(t)&&ce(t.length)&&!!y[Q(t)]}function zr(t){return function(e){return t(e)}}var et=typeof A=="object"&&A&&!A.nodeType&&A,$=et&&typeof I=="object"&&I&&!I.nodeType&&I,Xr=$&&$.exports===et,ee=Xr&&lt.process,Me=function(){try{var t=$&&$.require&&$.require("util").types;return t||ee&&ee.binding&&ee.binding("util")}catch{}}(),Oe=Me&&Me.isTypedArray,tt=Oe?zr(Oe):Qr,Jr=Object.prototype,Wr=Jr.hasOwnProperty;function Zr(t,e){var r=R(t),n=!r&&Ze(t),a=!r&&!n&&ne(t),s=!r&&!n&&!a&&tt(t),i=r||n||a||s,o=i?hr(t.length,String):[],u=o.length;for(var f in t)(e||Wr.call(t,f))&&!(i&&(f=="length"||a&&(f=="offset"||f=="parent")||s&&(f=="buffer"||f=="byteLength"||f=="byteOffset")||Je(f,u)))&&o.push(f);return o}function Vr(t,e){return function(r){return t(e(r))}}var en=Vr(Object.keys,Object),tn=Object.prototype,rn=tn.hasOwnProperty;function nn(t){if(!mr(t))return en(t);var e=[];for(var r in Object(t))rn.call(t,r)&&r!="constructor"&&e.push(r);return e}function rt(t){return gr(t)?Zr(t):nn(t)}function an(t,e){for(var r=-1,n=e.length,a=t.length;++r<n;)t[a+r]=e[r];return t}function sn(){this.__data__=new ie,this.size=0}function on(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}function un(t){return this.__data__.get(t)}function cn(t){return this.__data__.has(t)}var ln=200;function fn(t,e){var r=this.__data__;if(r instanceof ie){var n=r.__data__;if(!H||n.length<ln-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new ke(n)}return r.set(t,e),this.size=r.size,this}function P(t){var e=this.__data__=new ie(t);this.size=e.size}P.prototype.clear=sn;P.prototype.delete=on;P.prototype.get=un;P.prototype.has=cn;P.prototype.set=fn;function dn(t,e){for(var r=-1,n=t==null?0:t.length,a=0,s=[];++r<n;){var i=t[r];e(i,r,t)&&(s[a++]=i)}return s}function gn(){return[]}var pn=Object.prototype,mn=pn.propertyIsEnumerable,Ce=Object.getOwnPropertySymbols,hn=Ce?function(t){return t==null?[]:(t=Object(t),dn(Ce(t),function(e){return mn.call(t,e)}))}:gn;const yn=hn;function bn(t,e,r){var n=e(t);return R(t)?n:an(n,r(t))}function Le(t){return bn(t,rt,yn)}var ae=Y(x,"DataView"),se=Y(x,"Promise"),L=Y(x,"Set"),Re="[object Map]",wn="[object Object]",xe="[object Promise]",Fe="[object Set]",$e="[object WeakMap]",Be="[object DataView]",vn=F(ae),Tn=F(H),_n=F(se),An=F(L),In=F(re),E=Q;(ae&&E(new ae(new ArrayBuffer(1)))!=Be||H&&E(new H)!=Re||se&&E(se.resolve())!=xe||L&&E(new L)!=Fe||re&&E(new re)!=$e)&&(E=function(t){var e=Q(t),r=e==wn?t.constructor:void 0,n=r?F(r):"";if(n)switch(n){case vn:return Be;case Tn:return Re;case _n:return xe;case An:return Fe;case In:return $e}return e});const De=E;var Pn=x.Uint8Array;const je=Pn;var Sn="__lodash_hash_undefined__";function En(t){return this.__data__.set(t,Sn),this}function Mn(t){return this.__data__.has(t)}function D(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new ke;++e<r;)this.add(t[e])}D.prototype.add=D.prototype.push=En;D.prototype.has=Mn;function On(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}function nt(t,e){return t.has(e)}var Cn=1,Ln=2;function at(t,e,r,n,a,s){var i=r&Cn,o=t.length,u=e.length;if(o!=u&&!(i&&u>o))return!1;var f=s.get(t),g=s.get(e);if(f&&g)return f==e&&g==t;var c=-1,l=!0,d=r&Ln?new D:void 0;for(s.set(t,e),s.set(e,t);++c<o;){var p=t[c],w=e[c];if(n)var m=i?n(w,p,c,e,t,s):n(p,w,c,t,e,s);if(m!==void 0){if(m)continue;l=!1;break}if(d){if(!On(e,function(h,_){if(!nt(d,_)&&(p===h||a(p,h,r,n,s)))return d.push(_)})){l=!1;break}}else if(!(p===w||a(p,w,r,n,s))){l=!1;break}}return s.delete(t),s.delete(e),l}function Rn(t){var e=-1,r=Array(t.size);return t.forEach(function(n,a){r[++e]=[a,n]}),r}function le(t){var e=-1,r=Array(t.size);return t.forEach(function(n){r[++e]=n}),r}var xn=1,Fn=2,$n="[object Boolean]",Bn="[object Date]",Dn="[object Error]",jn="[object Map]",Un="[object Number]",Nn="[object RegExp]",Gn="[object Set]",qn="[object String]",Kn="[object Symbol]",kn="[object ArrayBuffer]",Hn="[object DataView]",Ue=de?de.prototype:void 0,te=Ue?Ue.valueOf:void 0;function Yn(t,e,r,n,a,s,i){switch(r){case Hn:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case kn:return!(t.byteLength!=e.byteLength||!s(new je(t),new je(e)));case $n:case Bn:case Un:return ft(+t,+e);case Dn:return t.name==e.name&&t.message==e.message;case Nn:case qn:return t==e+"";case jn:var o=Rn;case Gn:var u=n&xn;if(o||(o=le),t.size!=e.size&&!u)return!1;var f=i.get(t);if(f)return f==e;n|=Fn,i.set(t,e);var g=at(o(t),o(e),n,a,s,i);return i.delete(t),g;case Kn:if(te)return te.call(t)==te.call(e)}return!1}var Qn=1,zn=Object.prototype,Xn=zn.hasOwnProperty;function Jn(t,e,r,n,a,s){var i=r&Qn,o=Le(t),u=o.length,f=Le(e),g=f.length;if(u!=g&&!i)return!1;for(var c=u;c--;){var l=o[c];if(!(i?l in e:Xn.call(e,l)))return!1}var d=s.get(t),p=s.get(e);if(d&&p)return d==e&&p==t;var w=!0;s.set(t,e),s.set(e,t);for(var m=i;++c<u;){l=o[c];var h=t[l],_=e[l];if(n)var C=i?n(_,h,l,e,t,s):n(h,_,l,t,e,s);if(!(C===void 0?h===_||a(h,_,r,n,s):C)){w=!1;break}m||(m=l=="constructor")}if(w&&!m){var S=t.constructor,U=e.constructor;S!=U&&"constructor"in t&&"constructor"in e&&!(typeof S=="function"&&S instanceof S&&typeof U=="function"&&U instanceof U)&&(w=!1)}return s.delete(t),s.delete(e),w}var Wn=1,Ne="[object Arguments]",Ge="[object Array]",K="[object Object]",Zn=Object.prototype,qe=Zn.hasOwnProperty;function Vn(t,e,r,n,a,s){var i=R(t),o=R(e),u=i?Ge:De(t),f=o?Ge:De(e);u=u==Ne?K:u,f=f==Ne?K:f;var g=u==K,c=f==K,l=u==f;if(l&&ne(t)){if(!ne(e))return!1;i=!0,g=!1}if(l&&!g)return s||(s=new P),i||tt(t)?at(t,e,r,n,a,s):Yn(t,e,u,r,n,a,s);if(!(r&Wn)){var d=g&&qe.call(t,"__wrapped__"),p=c&&qe.call(e,"__wrapped__");if(d||p){var w=d?t.value():t,m=p?e.value():e;return s||(s=new P),a(w,m,r,n,s)}}return l?(s||(s=new P),Jn(t,e,r,n,a,s)):!1}function fe(t,e,r,n,a){return t===e?!0:t==null||e==null||!B(t)&&!B(e)?t!==t&&e!==e:Vn(t,e,r,n,fe,a)}var ea=1,ta=2;function ra(t,e,r,n){var a=r.length,s=a,i=!n;if(t==null)return!s;for(t=Object(t);a--;){var o=r[a];if(i&&o[2]?o[1]!==t[o[0]]:!(o[0]in t))return!1}for(;++a<s;){o=r[a];var u=o[0],f=t[u],g=o[1];if(i&&o[2]){if(f===void 0&&!(u in t))return!1}else{var c=new P;if(n)var l=n(f,g,u,t,e,c);if(!(l===void 0?fe(g,f,ea|ta,n,c):l))return!1}}return!0}function st(t){return t===t&&!dt(t)}function na(t){for(var e=rt(t),r=e.length;r--;){var n=e[r],a=t[n];e[r]=[n,a,st(a)]}return e}function it(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}function aa(t){var e=na(t);return e.length==1&&e[0][2]?it(e[0][0],e[0][1]):function(r){return r===t||ra(r,t,e)}}function sa(t,e){return t!=null&&e in Object(t)}function ia(t,e,r){e=gt(e,t);for(var n=-1,a=e.length,s=!1;++n<a;){var i=oe(e[n]);if(!(s=t!=null&&r(t,i)))break;t=t[i]}return s||++n!=a?s:(a=t==null?0:t.length,!!a&&ce(a)&&Je(i,a)&&(R(t)||Ze(t)))}function oa(t,e){return t!=null&&ia(t,e,sa)}var ua=1,ca=2;function la(t,e){return He(t)&&st(e)?it(oe(t),e):function(r){var n=pt(r,t);return n===void 0&&n===e?oa(r,t):fe(e,n,ua|ca)}}function fa(t){return function(e){return e==null?void 0:e[t]}}function da(t){return function(e){return mt(e,t)}}function ga(t){return He(t)?fa(oe(t)):da(t)}function pa(t){return typeof t=="function"?t:t==null?nr:typeof t=="object"?R(t)?la(t[0],t[1]):aa(t):ga(t)}function ma(t,e,r){for(var n=-1,a=t==null?0:t.length;++n<a;)if(r(e,t[n]))return!0;return!1}var ha=1/0,ya=L&&1/le(new L([,-0]))[1]==ha?function(t){return new L(t)}:ar,ba=200;function wa(t,e,r){var n=-1,a=cr,s=t.length,i=!0,o=[],u=o;if(r)i=!1,a=ma;else if(s>=ba){var f=e?null:ya(t);if(f)return le(f);i=!1,a=nt,u=new D}else u=e?[]:o;e:for(;++n<s;){var g=t[n],c=e?e(g):g;if(g=r||g!==0?g:0,i&&c===c){for(var l=u.length;l--;)if(u[l]===c)continue e;e&&u.push(c),o.push(g)}else a(u,c,r)||(u!==o&&u.push(c),o.push(g))}return o}function va(t,e){return t&&t.length?wa(t,pa(e)):[]}function Ke(){return Math.floor(new Date().getTime()/1e3)}const{updateBucket:k,setBucket:Oa,getBucket:Ta,deleteBucket:Ca}=j(ht);function _a(){const t=new Ye(M,!0);t.on("goOptionsPage",()=>{chrome.runtime.openOptionsPage()}),t.on("visitPricing",async()=>{b("visitPricingPage")}),t.on("setResumeCursors",async(e,r,n)=>{await k("resumeCursors",a=>{a[e]=a[e]||{},a[e][r]=a[e][r]||{},a[e][r].cursor=n,a[e][r].timestamp=Ke();const s=10,i=Object.entries(a[e]);if(i.length>s){i.sort((u,f)=>f[1].timestamp-u[1].timestamp);const o=i.slice(0,s).reduce((u,f)=>{const[g,c]=f;return u[g]=c,u},{});a[e]=o}return a})}),t.on("getResumeCursors",async e=>{const r=await Ta("resumeCursors");if(r[e])return r[e]}),t.on("removeResumeCursors",async(e,r)=>{await k("resumeCursors",n=>(!n[e]||!n[e][r]||delete n[e][r],n))}),t.on("pushRecordsToHistory",async(e,r)=>{k("history",n=>{const a=n.find(s=>s.historyId===e);return a&&(a.records.push(...r),a.records=va(a.records,"id")),n})}),t.on("createNewHistoryRecord",async e=>{k("history",r=>(r.find(a=>a.historyId===e.historyId)||r.push({...e,createdAt:Ke(),records:[]}),r))})}Bt({projectId:M,hostMatch:O});Zt(O);_a();Et({hostMatch:O,extensionId:M,extensionName:yt});er({projectId:M,callbackExtId:chrome.runtime.id,hostMatch:O});Wt({projectId:M,hostMatch:O,cacheId:"app-1.0.0",features:tr,defaultMemoConfig:rr});chrome.scripting.registerContentScripts([{id:`inject-${M}`,js:["injects/proxy.js"],matches:O,runAt:"document_start",world:"MAIN"}]);chrome.scripting.registerContentScripts([{id:`inject-${M}-module`,js:["injects/vendors.js","injects/index.js"],matches:O,runAt:"document_end",world:"MAIN"}])});export default Aa();
